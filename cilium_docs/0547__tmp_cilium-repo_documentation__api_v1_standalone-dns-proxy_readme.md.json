{
  "url": "file:///tmp/cilium-repo/Documentation/_api/v1/standalone-dns-proxy/README.md",
  "content": "Protocol Documentation \n \n Table of Contents \n \n \n standalone-dns-proxy/standalone-dns-proxy.proto \n \n \n DNSPolicy \n \n \n DNSServer \n \n \n EndpointInfo \n \n \n FQDNMapping \n \n \n IdentityToEndpointMapping \n \n \n PolicyState \n \n \n PolicyStateResponse \n \n \n UpdateMappingResponse \n \n \n ResponseCode \n \n \n FQDNData \n \n \n \n \n Scalar Value Types \n \n \n \n Top \n standalone-dns-proxy/standalone-dns-proxy.proto \n \n DNSPolicy \n L7 DNS policy specifying which requests are permitted to which DNS server \n Field Type Label Description \n source_endpoint_id uint32 Endpoint ID of the workload this L7 DNS policy should apply to \n dns_pattern string repeated Allowed DNS pattern this identity is allowed to resolve. \n dns_servers DNSServer repeated List of DNS servers to be allowed to connect. \n \n \n DNSServer \n DNServer identity, port and protocol the requests be allowed to \n Field Type Label Description \n dns_server_identity uint32 Identity of destination DNS server \n dns_server_port uint32 \n dns_server_proto uint32 \n \n \n EndpointInfo \n cilium endpoint ipaddress and ID \n Field Type Label Description \n id uint64 \n ip bytes repeated \n \n \n FQDNMapping \n FQDN-IP mapping goalstate sent from SDP to agent \n Field Type Label Description \n fqdn string dns name \n record_ip bytes repeated List of IPs corresponding to dns name \n ttl uint32 TTL of DNS record \n source_identity uint32 Identity of the client making the DNS request \n source_ip bytes IP address of the client making the DNS request \n response_code uint32 DNS Response code as specified in RFC2316 \n \n \n IdentityToEndpointMapping \n Cilium Identity ID to IP address mapping \n Field Type Label Description \n identity uint32 \n endpoint_info EndpointInfo repeated \n \n \n PolicyState \n L7 DNS policy snapshot of all local endpoints and identity to ip mapping of source\nand destinatione egress endpoints enforcing fqdn rules. \n Field Type Label Description \n egress_l7_dns_policy DNSPolicy repeated \n request_id string Random UUID based identifier which will be referenced in ACKs \n identity_to_endpoint_mapping IdentityToEndpointMapping repeated Identity to Endpoint mapping for the DNS server and the source identity \n \n \n PolicyStateResponse \n Ack sent from SDP to Agent on processing DNS policy rules \n Field Type Label Description \n response ResponseCode \n request_id string Request ID for which response is sent to \n \n \n UpdateMappingResponse \n Ack returned by cilium agent to SDP on receiving FQDN-IP mapping update \n Field Type Label Description \n response ResponseCode \n \n \n ResponseCode \n Response code returned by RPC methods. \n Name Number Description \n RESPONSE_CODE_UNSPECIFIED 0 \n RESPONSE_CODE_NO_ERROR 1 \n RESPONSE_CODE_FORMAT_ERROR 2 \n RESPONSE_CODE_SERVER_FAILURE 3 \n RESPONSE_CODE_NOT_IMPLEMENTED 4 \n RESPONSE_CODE_REFUSED 5 \n \n \n FQDNData \n Cilium agent runs the FQDNData service and Standalone DNS proxy connects to it to get the DNS Policy rules.\nStandalone DNS proxy sends FQDN-IP mapping updates to Cilium Agent.\nCFP: https://github.com/cilium/design-cfps/pull/54 \n Method Name Request Type Response Type Description \n StreamPolicyState PolicyStateResponse  stream PolicyState  stream StreamPolicyState is used by the Standalone DNS proxy to get the current policy state. Policy state includes the DNS policies and the identity to IP mapping. Cilium agent will stream DNS policies state to Standalone DNS proxy. In case of any client side error, cilium agent will cancel the stream and SDP will have to re-subscribe. In case of any server side error, cilium agent will send an error response and SDP will have to re-subscribe. \n UpdateMappingRequest FQDNMapping UpdateMappingResponse UpdateMappingRequest is used by the Standalone DNS proxy to update ciliium agent with FQDN-IP mappings which in turn update L3/L4 policy maps. In case of any error, SDP will either retry the connection if the error is server side or will error out. Note: In case of concurrent updates, since this is called in a callback(notifyDNSMsg) from the DNS server it follows the same behavior as the inbuilt dns proxy in cilium. \n \n Scalar Value Types \n .proto Type Notes C++ Java Python Go C# PHP Ruby \n  double double double float float64 double float Float \n  float float float float float32 float float Float \n  int32 Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint32 instead. int32 int int int32 int integer Bignum or Fixnum (as required) \n  int64 Uses variable-length encoding. Inefficient for encoding negative numbers – if your field is likely to have negative values, use sint64 instead. int64 long int/long int64 long integer/string Bignum \n  uint32 Uses variable-length encoding. uint32 int int/long uint32 uint integer Bignum or Fixnum (as required) \n  uint64 Uses variable-length encoding. uint64 long int/long uint64 ulong integer/string Bignum or Fixnum (as required) \n  sint32 Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int32s. int32 int int int32 int integer Bignum or Fixnum (as required) \n  sint64 Uses variable-length encoding. Signed int value. These more efficiently encode negative numbers than regular int64s. int64 long int/long int64 long integer/string Bignum \n  fixed32 Always four bytes. More efficient than uint32 if values are often greater than 2^28. uint32 int int uint32 uint integer Bignum or Fixnum (as required) \n  fixed64 Always eight bytes. More efficient than uint64 if values are often greater than 2^56. uint64 long int/long uint64 ulong integer/string Bignum \n  sfixed32 Always four bytes. int32 int int int32 int integer Bignum or Fixnum (as required) \n  sfixed64 Always eight bytes. int64 long int/long int64 long integer/string Bignum \n  bool bool boolean boolean bool bool boolean TrueClass/FalseClass \n  string A string must always contain UTF-8 encoded or 7-bit ASCII text. string String str/unicode string string string String (UTF-8) \n  bytes May contain any arbitrary sequence of bytes. string ByteString str []byte ByteString string String (ASCII-8BIT)",
  "item_type": "markdown",
  "module_path": "/tmp/cilium-repo/Documentation/_api/v1/standalone-dns-proxy/README.md",
  "extracted_at": "2025-09-03T01:13:29.270241Z"
}