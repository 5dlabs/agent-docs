{
  "url": "file:///tmp/cilium-repo/Documentation/contributing/development/images.rst",
  "content": ".. only:: not (epub or latex or html)\n\n    WARNING: You are looking at unreleased Cilium documentation.\n    Please use the official rendered version released here:\n    https://docs.cilium.io\n\n.. _container_images:\n\nBuilding Container Images\n=========================\n\nTwo make targets exists to build container images automatically based on the\nlocally checked out branch:\n\nDeveloper images\n~~~~~~~~~~~~~~~~\n\nRun ``make dev-docker-image`` to build a cilium-agent Docker image that\ncontains your local changes.\n\n.. code-block:: shell-session\n\n    ARCH=amd64 DOCKER_DEV_ACCOUNT=quay.io/myaccount DOCKER_IMAGE_TAG=jane-developer-my-fix make dev-docker-image\n\nRun ``make docker-operator-generic-image`` (respectively,\n``docker-operator-aws-image`` or ``docker-operator-azure-image``) to build the\ncilium-operator Docker image:\n\n.. code-block:: shell-session\n\n    ARCH=amd64 DOCKER_DEV_ACCOUNT=quay.io/myaccount DOCKER_IMAGE_TAG=jane-developer-my-fix make docker-operator-generic-image\n\nThe commands above assumes that your username for ``quay.io`` is ``myaccount``.\n\n~~~~~~~~~~~~~~\nRace detection\n~~~~~~~~~~~~~~\n\nSee section on :ref:`compiling Cilium with race detection\n<compile-cilium-with-race-detection>`.\n\nOfficial release images\n~~~~~~~~~~~~~~~~~~~~~~~\n\nAnyone can build official release images using the make target below.\n\n.. code-block:: shell-session\n\n    DOCKER_IMAGE_TAG=v1.4.0 make docker-images-all\n\nOfficial Cilium repositories\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nThe following table contains the main container image repositories managed by the Cilium team. All images are built via Github\nActions from their corresponding Github repositories. All images are `multi-platform <https://docs.docker.com/build/building/multi-platform/>`_\nwith support for both ``linux/amd64`` and ``linux/arm64`` platforms.\n\n+-------------------------------+---------------------------------------------+-----------------------------------------------+\n|     **Github Repository**     |                **Dockerfile**               |      **Container image repository**           |\n|                               |                                             |                                               +\n|                               |                                             |                                               |\n+-------------------------------+---------------------------------------------+-----------------------------------------------+\n| github.com/cilium/cilium      | images/builder/Dockerfile                   | quay.io/cilium/cilium-builder                 |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/cilium-docker-plugin/Dockerfile      | [quay|docker].io/cilium/docker-plugin         |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/cilium/Dockerfile                    | [quay|docker].io/cilium/cilium                |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/clustermesh-apiserver/Dockerfile     | [quay|docker].io/cilium/clustermesh-apiserver |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/hubble-relay/Dockerfile              | [quay|docker].io/cilium/hubble-relay          |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/operator/Dockerfile                  | [quay|docker].io/cilium/operator              |\n|                               +                                             +-----------------------------------------------+\n|                               |                                             | [quay|docker].io/cilium/operator-alibabacloud |\n|                               +                                             +-----------------------------------------------+\n|                               |                                             | [quay|docker].io/cilium/operator-aws          |\n|                               +                                             +-----------------------------------------------+\n|                               |                                             | [quay|docker].io/cilium/operator-azure        |\n|                               +                                             +-----------------------------------------------+\n|                               |                                             | [quay|docker].io/cilium/operator-generic      |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/runtime/Dockerfile                   | quay.io/cilium/cilium-runtime                 |\n+-------------------------------+---------------------------------------------+-----------------------------------------------+\n| github.com/cilium/cilium-cli  | Dockerfile                                  | quay.io/cilium/cilium-cli                     |\n+-------------------------------+---------------------------------------------+-----------------------------------------------+\n| github.com/cilium/image-tools | images/bpftool/Dockerfile                   | quay.io/cilium/cilium-bpftool                 |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/compilers/Dockerfile                 | quay.io/cilium/image-compilers                |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/llvm/Dockerfile                      | quay.io/cilium/cilium-llvm                    |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/maker/Dockerfile                     | quay.io/cilium/image-maker                    |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | images/startup-script/Dockerfile            | quay.io/cilium/startup-script                 |\n+-------------------------------+---------------------------------------------+-----------------------------------------------+\n| github.com/cilium/proxy       | Dockerfile.builder                          | quay.io/cilium/cilium-envoy-builder           |\n|                               +---------------------------------------------+-----------------------------------------------+\n|                               | Dockerfile                                  | quay.io/cilium/cilium-envoy                   |\n+-------------------------------+---------------------------------------------+-----------------------------------------------+\n\nImages dependency:\n\n::\n\n    cilium/cilium\n    └── cilium/cilium-builder\n        └── cilium/cilium-runtime\n            ├── cilium/cilium-bpftool\n            └── cilium/cilium-llvm\n\n    cilium/cilium-envoy\n    └── cilium/cilium-envoy-builder\n        └── cilium/cilium-builder\n            └── cilium/cilium-runtime\n                ├── cilium/cilium-bpftool\n                └── cilium/cilium-llvm\n\n    cilium/operator\n    └── cilium/cilium-builder\n        └── cilium/cilium-runtime\n            ├── cilium/cilium-bpftool\n            └── cilium/cilium-llvm\n\n\n\n.. _update_cilium_builder_runtime_images:\n\nUpdate cilium-builder and cilium-runtime images\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nThe steps described here, starting with a commit that updates the image\nversions, build the necessary images and update all the appropriate\nlocations in the Cilium codebase. Hence, before executing the following steps,\nthe user should have such a commit (e.g., see\n`this commit\n<https://github.com/cilium/cilium/pull/17713/commits/b7a37ff80df8681d25a24fd5b464082d360fc6e2>`__)\nin their local tree. After following the steps below, the result would be another\ncommit with the image updates (e.g,. see `this commit\n<https://github.com/cilium/cilium/pull/17713/commits/bd3357704647117fa9ef4839b9f603cd0435b7cc>`__).\nPlease keep the two commits separate to ease backporting.\n\nIf you only wish to update the packages in these images, then you can manually\nupdate the ``FORCE_BUILD`` variable in ``images/runtime/Dockerfile`` to have a\ndifferent value and then proceed with the steps below.\n\n#. Commit your changes and create a PR in cilium/cilium.\n\n   .. code-block:: shell-session\n\n       $ git commit -sam \"images: update cilium-{runtime,builder}\"\n\n#. Ping one of the members of `team/build <https://github.com/orgs/cilium/teams/build/members>`__\n   to approve the build that was created by GitHub Actions `here <https://github.com/cilium/cilium/actions?query=workflow:%22Base+Image+Release+Build%22>`__.\n   Note that at this step cilium-builder build failure is expected since we have yet to update the runtime digest.\n\n#. Wait for build to complete. If the PR was opened from an external fork the\n   build will fail while trying to push the changes, this is expected.\n\n#. If the PR was opened from an external fork, run the following commands and\n   re-push the changes to your branch. Once this is done the CI can be executed.\n\n   .. code-block:: shell-session\n\n       $ make -C images/ update-runtime-image\n       $ git commit -sam \"images: update cilium-{runtime,builder}\" --amend\n       $ make -C images/ update-builder-image\n       $ git commit -sam \"images: update cilium-{runtime,builder}\" --amend\n\n#. If the PR was opened from the main repository, the build will automatically\n   generate one commit and push it to your branch with all the necessary changes\n   across files in the repository.\n\n#. Run the full CI and ensure that it passes.\n\n#. Merge the PR.\n\nImage Building Process\n~~~~~~~~~~~~~~~~~~~~~~\n\nImages are automatically created by a GitHub action: ``build-images``. This\naction will automatically run for any Pull Request, including Pull Requests\nsubmitted from forked repositories, and push the images into\n``quay.io/cilium/*-ci``. They will be available there for 1 week before they are\nremoved by the ``ci-images-garbage-collect`` workflow. Once they are removed, the\ndeveloper must re-push the Pull Request into GitHub so that new images are\ncreated.\n",
  "item_type": "unknown",
  "module_path": "/tmp/cilium-repo/Documentation/contributing/development/images.rst",
  "extracted_at": "2025-09-03T01:13:28.817212Z"
}