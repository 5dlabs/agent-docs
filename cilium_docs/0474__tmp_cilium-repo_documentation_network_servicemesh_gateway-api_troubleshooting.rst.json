{
  "url": "file:///tmp/cilium-repo/Documentation/network/servicemesh/gateway-api/troubleshooting.rst",
  "content": "This page guides you through the different mechanics of Gateway API and how to troubleshoot them.\n\nBe sure to follow the Generic and Setup Verification steps from the :ref:`Troubleshooting Ingress & Service Mesh page<troubleshooting_servicemesh>`.\n\nChecking resources\n******************\n\n#. Check the Gateway resource \n\n    .. code-block:: shell-session\n\n      $ kubectl get gateway -A\n      NAMESPACE                   NAME                 CLASS    ADDRESS          PROGRAMMED   AGE\n      website                     http-gateway         cilium   172.21.255.202   True         5h\n      webshop                     tls-gateway          cilium   172.21.255.203   True         5h\n  \n    The preceding command returns an overview of all the Gateways in the cluster. Check the following:\n\n    * Is the Gateway programmed? \n    \n        A programmed Gateway means that Cilium prepared a configuration for it.\n      \n      * If the ``Programmed true`` indicator is missing, make sure that Gateway API is enabled in the Cilium configuration.\n  \n    * Does the gateway have an address?\n    \n    You can check the service with ``kubectl get service``. \n    If the gateway has an address, it means that a LoadBalancer service is assigned to the gateway.\n    If no IP appears, you might be missing a LoadBalancer implementation.\n  \n    * Is the class ``cilium``? \n    \n    Cilium only programs Gateways with the class ``cilium``.\n    \n    * If the Gateway API resource type (``Gateway``, ``HTTPRoute``, etc.) is not found, make sure that the Gateway API CRDs are installed.\n\n    You can use ``kubectl describe gateway`` to investigate issues more thoroughly.\n\n    .. code-block:: shell-session\n\n      $ kubectl describe gateway <name>\n\n        Conditions:\n          Message:               Gateway successfully scheduled\n          Reason:                Accepted\n          Status:                True\n          Type:                  Accepted\n          Message:               Gateway successfully reconciled\n          Reason:                Programmed\n          Status:                True\n          Type:                  Programmed\n          [...]\n        Listeners:\n          Attached Routes:  2\n          Conditions:\n            Message:               Listener Ready\n            Reason:                Programmed\n            Status:                True\n            Type:                  Programmed\n            Message:               Listener Accepted\n            Reason:                Accepted\n            Status:                True\n            [...]\n\n    You can see the general status of the gateway as well as the status of the configured listeners.\n    \n    Listener status displays the number of routes successfully attached to the listener.\n    \n    You can see status conditions for both gateway and listener:\n\n      * ``Accepted``: the Gateway configuration was accepted.\n      * ``Programmed``: the Gateway configuration was programmed into Envoy.\n      * ``ResolvedRefs``: all referenced secrets were found and have permission for use.\n  \n    If any of these conditions are set to false, the ``Message`` and ``Reason`` fields give more information.\n\n#. Check the HTTPRoute resource\n\n  When the Gateway is functional, you can check the routes to verify if they are configured correctly.\n  The way to check route status is similar to checking the status of a gateway resource. \n  \n  While these instructions are written for HTTPRoute, they also apply to other route types.\n\n  .. code-block:: shell-session\n\n    $ kubectl get httproute -A\n    NAMESPACE                 NAME              HOSTNAMES         AGE\n    website                   homepage          www.example.org   17m\n    webshop                   catalog-service                     17m\n    webshop                   cart-service                        17m\n\n  To get more information, enter ``kubectl describe httproute <name>``.\n\n  .. code-block:: shell-session\n\n    $ kubectl describe httproute <name>\n    Status:\n      Parents:\n        Conditions:\n          Last Transition Time:  2023-06-05T15:11:53Z\n          Message:               Accepted HTTPRoute\n          Observed Generation:   1\n          Reason:                Accepted\n          Status:                True\n          Type:                  Accepted\n          Last Transition Time:  2023-06-05T15:11:53Z\n          Message:               Service reference is valid\n          Observed Generation:   1\n          Reason:                ResolvedRefs\n          Status:                True\n          Type:                  ResolvedRefs\n        Controller Name:         io.cilium/gateway-controller\n        Parent Ref:\n          Group:  gateway.networking.k8s.io\n          Kind:   Gateway\n          Name:   same-namespace\n\n  Status lists the conditions that are relevant for the specific ``HTTPRoute``.\n  Conditions are listed by parent reference to the gateway. If you linked the route to multiple gateways, multiple entries appear.\n  Conditions include ``Reason``, ``Type``, ``Status`` and ``Message``. ``Type`` indicates the condition type, and ``Status`` indicates with a boolean whether the condition type is met. Optionally, ``Message`` gives you more information about the condition.\n  \n  Notice the following condition types:\n\n  * ``Accepted``: The HTTPRoute configuration was correct and accepted.\n  * ``ResolvedRefs``: The referenced services were found and are valid references.\n  \n  If any of these are set to false, you can get more information by looking at the ``Message`` and ``Reason`` fields.\n\n#. Check Cilium Operator logs\n\n  The Cilium Operator logs may contain further debugging information. For example, if the required Custom Resource Definitions (CRDs) are not installed, an error will be logged:\n\n  .. code-block:: shell-session\n    \n    $ kubectl logs -n kube-system deployments/cilium-operator | grep gateway\n    level=error msg=\"Required GatewayAPI resources are not found, please\n    refer to docs for installation instructions\" error=\"customresourcedefinitions.apiextensions.k8s.io \\\"gatewayclasses.gateway.networking.k8s.io\\\" not found\n    customresourcedefinitions.apiextensions.k8s.io \\\"gateways.gateway.networking.k8s.io\\\" not found\n    customresourcedefinitions.apiextensions.k8s.io \\\"httproutes.gateway.networking.k8s.io\\\" not found\n    customresourcedefinitions.apiextensions.k8s.io \\\"referencegrants.gateway.networking.k8s.io\\\" not found\n    customresourcedefinitions.apiextensions.k8s.io \\\"grpcroutes.gateway.networking.k8s.io\\\" not found\n    customresourcedefinitions.apiextensions.k8s.io \\\"tlsroutes.gateway.networking.k8s.io\\\" not found\" subsys=gateway-api\n\nCommon mistakes\n***************\n\n.. include:: mistakes-warning.rst\n\n* The backend service does not exist. \n\n    To verify whether the backend service was found, run ``kubectl describe httproute <name>`` and inspect the ``conditions`` field:\n  \n  .. code-block:: shell-session\n\n        Parents:\n          Conditions:\n            Last Transition Time:  2023-06-06T13:55:10Z\n            Message:               Service \"backend\" not found\n            Observed Generation:   1\n            Reason:                BackendNotFound\n            Status:                False\n            Type:                  ResolvedRefs\n            Last Transition Time:  2023-06-06T13:55:10Z\n            Message:               Accepted HTTPRoute\n            Observed Generation:   1\n            Reason:                Accepted\n            Status:                True\n            Type:                  Accepted\n          Controller Name:         io.cilium/gateway-controller\n\n* The gateway specified under ``parentRefs`` does not exist.\n\n    To verify whether the gateway was found, run ``kubectl describe httproute <name>`` and inspect the ``conditions`` field:\n   \n.. code-block:: shell-session\n\n  Parents:\n    Conditions:\n      Last Transition Time:  2023-06-06T13:56:40Z\n      Message:               Gateway.gateway.networking.k8s.io \"my-gateway\" not found\n      Observed Generation:   2\n        Reason:                InvalidHTTPRoute\n        Status:                False\n        Type:                  Accepted\n\nUnderlying mechanics: a high level overview\n*******************************************\n\nA Cilium deployment has two parts that handle Gateway API resources: the Cilium agent and the Cilium operator.\n\nThe Cilium operator watches all Gateway API resources and verifies whether the resources are valid.\nIf resources are valid, the operator marks them as accepted. That starts the process of translation into Cilium Envoy Configuration resources.\n\nThe Cilium agent then picks up the Cilium Envoy Configuration resources.\n\nThe Cilium agent uses the resources to supply the configuration to the built in Envoy or the Envoy DaemonSet. Envoy handles traffic.\n",
  "item_type": "unknown",
  "module_path": "/tmp/cilium-repo/Documentation/network/servicemesh/gateway-api/troubleshooting.rst",
  "extracted_at": "2025-09-03T01:13:29.166747Z"
}