{
  "url": "file:///tmp/cilium-repo/Documentation/network/concepts/ipam/kubernetes.rst",
  "content": ".. only:: not (epub or latex or html)\n\n    WARNING: You are looking at unreleased Cilium documentation.\n    Please use the official rendered version released here:\n    https://docs.cilium.io\n\n.. _k8s_hostscope:\n\n#####################\nKubernetes Host Scope\n#####################\n\nThe Kubernetes host-scope IPAM mode is enabled with ``ipam: kubernetes`` and\ndelegates the address allocation to each individual node in the cluster. IPs\nare allocated out of the ``PodCIDR`` range associated to each node by\nKubernetes.\n\n.. image:: k8s_hostscope.png\n    :align: center\n\nIn this mode, the Cilium agent will wait on startup until the ``PodCIDR`` range\nis made available via the Kubernetes ``v1.Node`` object for all enabled address\nfamilies via one of the following methods:\n\n**via v1.Node resource field**\n\n==================== ============================================================\nField                Description\n==================== ============================================================\n``spec.podCIDRs``    IPv4 and/or IPv6 PodCIDR range\n``spec.podCIDR``     IPv4 or IPv6 PodCIDR range\n==================== ============================================================\n\n.. note:: It is important to run the ``kube-controller-manager`` with the flag\n\t  ``--allocate-node-cidrs`` flag to indicate to Kubernetes that PodCIDR\n\t  ranges should be allocated.\n\n**via v1.Node annotation**\n\n====================================== ==========================================================\nAnnotation                             Description\n====================================== ==========================================================\n``network.cilium.io/ipv4-pod-cidr``    IPv4 PodCIDR range\n``network.cilium.io/ipv6-pod-cidr``    IPv6 PodCIDR range\n``network.cilium.io/ipv4-cilium-host`` IPv4 address of the cilium host interface\n``network.cilium.io/ipv6-cilium-host`` IPv6 address of the cilium host interface\n``network.cilium.io/ipv4-health-ip``   IPv4 address of the cilium-health endpoint\n``network.cilium.io/ipv6-health-ip``   IPv6 address of the cilium-health endpoint\n``network.cilium.io/ipv4-Ingress-ip``  IPv4 address of the cilium-ingress endpoint\n``network.cilium.io/ipv6-Ingress-ip``  IPv6 address of the cilium-ingress endpoint\n====================================== ==========================================================\n\n.. note:: The annotation-based mechanism is primarily useful in combination with\n\t  older Kubernetes versions which do not support ``spec.podCIDRs`` yet\n\t  but support for both IPv4 and IPv6 is enabled.\n\n.. _hostscope_configuration:\n\n*************\nConfiguration\n*************\n\nThe following ConfigMap options exist to configure Kubernetes hostscope:\n\n * ``ipam: kubernetes``: Enables Kubernetes IPAM mode. Enabling this option will\n   automatically enable ``k8s-require-ipv4-pod-cidr`` if ``enable-ipv4`` is\n   ``true`` and ``k8s-require-ipv6-pod-cidr`` if ``enable-ipv6`` is ``true``.\n * ``k8s-require-ipv4-pod-cidr: true``: instructs the Cilium agent to wait until\n   an IPv4 PodCIDR is made available via the Kubernetes node resource.\n * ``k8s-require-ipv6-pod-cidr: true``: instructs the Cilium agent to wait until\n   an IPv6 PodCIDR is made available via the Kubernetes node resource.\n\nWith helm the previous options can be defined as:\n\n * ``ipam: kubernetes``: ``--set ipam.mode=kubernetes``.\n * ``k8s-require-ipv4-pod-cidr: true``: ``--set k8s.requireIPv4PodCIDR=true``,\n   which only works with ``--set ipam.mode=kubernetes``\n * ``k8s-require-ipv6-pod-cidr: true``: ``--set k8s.requireIPv6PodCIDR=true``,\n   which only works with ``--set ipam.mode=kubernetes``\n",
  "item_type": "unknown",
  "module_path": "/tmp/cilium-repo/Documentation/network/concepts/ipam/kubernetes.rst",
  "extracted_at": "2025-09-03T01:13:29.210112Z"
}