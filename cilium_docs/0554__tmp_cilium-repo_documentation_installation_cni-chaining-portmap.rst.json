{
  "url": "file:///tmp/cilium-repo/Documentation/installation/cni-chaining-portmap.rst",
  "content": ".. only:: not (epub or latex or html)\n\n    WARNING: You are looking at unreleased Cilium documentation.\n    Please use the official rendered version released here:\n    https://docs.cilium.io\n\n\n.. _k8s_install_portmap:\n\n******************\nPortmap (HostPort)\n******************\n\nStarting from Cilium 1.8, the Kubernetes HostPort feature is supported natively\nthrough Cilium's eBPF-based kube-proxy replacement. CNI chaining is therefore\nnot needed anymore. For more information, see section :ref:`kubeproxyfree_hostport`.\n\nHowever, for the case where Cilium is deployed as ``kubeProxyReplacement=false``,\nthe HostPort feature can then be enabled via CNI chaining with the portmap plugin which\nimplements HostPort. This guide documents how to enable the latter for the chaining\ncase.\n\nFor more general information about the Kubernetes HostPort feature, check out the\nupstream documentation:\n`Kubernetes hostPort-CNI plugin documentation\n<https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/#support-hostport>`_.\n\n.. note::\n\n   Before using HostPort, read the `Kubernetes Configuration Best Practices\n   <https://kubernetes.io/docs/concepts/configuration/overview/>`_ to\n   understand the implications of this feature.\n\nDeploy Cilium with the portmap plugin enabled\n=============================================\n\nInstall the ``portmap`` binaries. Some Kubernetes distributions will do this for\nyou, in which case you don't need to do anything. However, if ``portmap`` is not\navailable on your worker nodes, you must install it into ``/opt/cni/bin/``. You\ncan find binaries from the `CNI project releases page <https://github.com/containernetworking/plugins/releases>`_.\n\n.. include:: k8s-install-download-release.rst\n\nDeploy Cilium release via Helm:\n\n.. parsed-literal::\n\n    helm install cilium |CHART_RELEASE| \\\\\n      --namespace=kube-system \\\\\n      --set cni.chainingMode=portmap\n\n.. note::\n\n   You can combine the ``cni.chainingMode=portmap`` option with any of\n   the other installation guides.\n\nAs Cilium is deployed as a DaemonSet, it will write a new CNI configuration. The new\nconfiguration now enables HostPort. Any new pod scheduled is now able to make\nuse of the HostPort functionality.\n\nRestart existing pods\n=====================\n\nThe new CNI chaining configuration will *not* apply to any pod that is already\nrunning the cluster. Existing pods will be reachable and Cilium will\nload-balance to them but policy enforcement will not apply to them and\nload-balancing is not performed for traffic originating from existing pods.\nYou must restart these pods in order to invoke the chaining configuration on\nthem.\n",
  "item_type": "unknown",
  "module_path": "/tmp/cilium-repo/Documentation/installation/cni-chaining-portmap.rst",
  "extracted_at": "2025-09-03T01:13:29.301409Z"
}