{
  "url": "file:///tmp/cilium-repo/Documentation/installation/cni-chaining-generic-veth.rst",
  "content": ".. only:: not (epub or latex or html)\n\n    WARNING: You are looking at unreleased Cilium documentation.\n    Please use the official rendered version released here:\n    https://docs.cilium.io\n\n.. _generic_veth_cni_chaining:\n\n*********************\nGeneric Veth Chaining\n*********************\n\nThe generic veth chaining plugin enables CNI chaining on top of any CNI plugin\nthat is using a veth device model. The majority of CNI plugins use such a\nmodel.\n\n.. include:: cni-chaining-limitations.rst\n\nValidate that the current CNI plugin is using veth\n==================================================\n\n1. Log into one of the worker nodes using SSH\n2. Run ``ip -d link`` to list all network devices on the node. You should be\n   able spot network devices representing the pods running on that node.\n3. A network device might look something like this:\n\n   .. code-block:: shell-session\n\n       103: lxcb3901b7f9c02@if102: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000\n           link/ether 3a:39:92:17:75:6f brd ff:ff:ff:ff:ff:ff link-netnsid 18 promiscuity 0\n           veth addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535\n4. The ``veth`` keyword on line 3 indicates that the network device type is virtual ethernet.\n\nIf the CNI plugin you are chaining with is currently not using veth then the\n``generic-veth`` plugin is not suitable. In that case, a full CNI chaining\nplugin is required which understands the device model of the underlying plugin.\nWriting such a plugin is trivial, contact us on `Cilium Slack`_ for more\ndetails.\n\nCreate a CNI configuration to define your chaining configuration\n================================================================\n\nCreate a ``chaining.yaml`` file based on the following template to specify the\ndesired CNI chaining configuration:\n\n\n.. code-block:: yaml\n\n    apiVersion: v1\n    kind: ConfigMap\n    metadata:\n      name: cni-configuration\n      namespace: kube-system\n    data:\n      cni-config: |-\n        {\n          \"name\": \"generic-veth\",\n          \"cniVersion\": \"0.3.1\",\n          \"plugins\": [\n            {\n              \"type\": \"XXX\",\n\t      [...]\n            },\n            {\n              \"type\": \"cilium-cni\",\n              \"chaining-mode\": \"generic-veth\"\n            }\n          ]\n        }\n\nDeploy the :term:`ConfigMap`:\n\n.. code-block:: shell-session\n\n   kubectl apply -f chaining.yaml\n\nDeploy Cilium with the portmap plugin enabled\n=============================================\n\n.. include:: k8s-install-download-release.rst\n\nDeploy Cilium release via Helm:\n\n.. parsed-literal::\n\n    helm install cilium |CHART_RELEASE| \\\\\n      --namespace=kube-system \\\\\n      --set cni.chainingMode=generic-veth \\\\\n      --set cni.customConf=true \\\\\n      --set cni.configMap=cni-configuration \\\\\n      --set routingMode=native \\\\\n      --set enableIPv4Masquerade=false\n",
  "item_type": "unknown",
  "module_path": "/tmp/cilium-repo/Documentation/installation/cni-chaining-generic-veth.rst",
  "extracted_at": "2025-09-03T01:13:29.310697Z"
}