{
  "url": "file:///tmp/cilium-repo/Documentation/internals/security-identities.rst",
  "content": ".. only:: not (epub or latex or html)\n\n    WARNING: You are looking at unreleased Cilium documentation.\n    Please use the official rendered version released here:\n    https://docs.cilium.io\n\n.. _security_identities:\n\n*******************\nSecurity Identities\n*******************\n\nSecurity identities are generated from labels. They are stored as ``uint32``,\nwhich means the maximum limit for a security identity is ``2^32 - 1``. The\nminimum security identity is ``1``.\n\n.. note::\n\n   Identity 0 is not a valid value. If it shows up in Hubble output, this means\n   the identity was not found. In the eBPF datapath, it has a special role\n   where it denotes \"any identity\", i.e. as a wildcard allow in policy maps.\n\nSecurity identities span over several ranges, depending on the context:\n\n1) Cluster-local\n2) ClusterMesh\n3) Identities generated from CIDR-based policies\n4) Identities generated for remote nodes (optional)\n\nCluster-local\n~~~~~~~~~~~~~\n.. _local_scoped_identity:\n\nCluster-local identities (1) range from ``1`` to ``2^16 - 1``. The lowest\nvalues, from ``1`` to ``255``, correspond to the reserved identity range.  See\nthe `internal code documentation\n<https://pkg.go.dev/github.com/cilium/cilium/pkg/identity#NumericIdentity>`__\nfor details.\n\nClustermesh\n~~~~~~~~~~~\n.. _clustermesh_identity:\n\nFor ClusterMesh (2), 8 bits are used as the ``cluster-id`` which identifies the\ncluster in the ClusterMesh, into the 3rd octet as shown by ``0x00FF0000``. The\n4th octet (uppermost bits) must be set to ``0`` as well. Neither of these\nconstraints apply CIDR identities however, see (3).\n\nCIDR-based identity\n~~~~~~~~~~~~~~~~~~~\n.. _cidr_based_identity:\n\nCIDR identities (3) are local to each node. CIDR identities begin from ``1``\nand end at ``16777215``, however since they're shifted by ``24``, this makes\ntheir effective range ``1 | (1 << 24)`` to ``16777215 | (1 << 24)`` or from\n``16777217`` to ``33554431``. When CIDR policies are applied, the identity\ngenerated is local to each node. In other words, the identity may not be the\nsame for the same CIDR policy across two nodes.\n\nNode-local identity\n~~~~~~~~~~~~~~~~~~~\n.. _remote_node_scoped_identity:\n\nRemote-node identities (4) are also local to each node. Functionally, they\nwork much the same as CIDR identities: they are local to each node, potentially\ndiffering across nodes on the cluster. They are used when the option\n``policy-cidr-match-mode`` includes ``nodes`` or when ``enable-node-selector-labels``\nis set to ``true``.\n\nNode-local identities (CIDR or remote-node) are never used for traffic\nbetween Cilium-managed nodes, so they do not need to fit inside of a\nVXLAN or Geneve virtual network field.\nNon-CIDR identities are limited to 24 bits so that they will fit in these\nfields on the wire, but since CIDR identities will not be encoded in these\npackets, they can start with a higher value. Hence, the minimum value for a\nCIDR identity is ``2^24 + 1``.\n\nOverall, the following represents the different ranges:\n\n::\n\n   0x00000001 - 0x000000FF (1           to 2^8  - 1       ) => reserved identities\n   0x00000100 - 0x0000FFFF (2^8         to 2^16 - 1       ) => cluster-local identities\n   0x00010000 - 0x00FFFFFF (2^16        to 2^24 - 1       ) => identities for remote clusters\n   0x01000000 - 0x01FFFFFF (2^24        to 2^25 - 1       ) => identities for CIDRs (node-local)\n   0x02000000 - 0x02FFFFFF (2^25        to 2^25 + 2^24 - 1) => identities for remote nodes (local)\n   0x01010000 - 0xFFFFFFFF (2^25 + 2^24 to 2^32 - 1       ) => reserved for future use\n",
  "item_type": "unknown",
  "module_path": "/tmp/cilium-repo/Documentation/internals/security-identities.rst",
  "extracted_at": "2025-09-03T01:13:29.361894Z"
}